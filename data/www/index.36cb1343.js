const e="#val-weight",t="#val-time",a="#val-time-est",i="#diagram",o="#title";let r={chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1},animations:{enabled:!1,dynamicAnimation:{speed:1e3}}},series:[{data:[]}],xaxis:{type:"numeric",decimalsInFloat:1,title:{text:"Time (s)"},labels:{formatter:e=>(e/1e3).toFixed(0)}},yaxis:{decimalsInFloat:0,title:{text:"Weight (g)"}},dataLabels:{enabled:!1},stroke:{curve:["smooth","straight"],width:[3,1],dashArray:[0,8]},markers:{size:0},legend:{show:!1}},n=new ApexCharts(document.querySelector(i),r);function s(e){return`${(e/1e3).toFixed(1)}s`}n.render();let l=!1;setInterval((async()=>{if(!l){l=!0;try{const i=await fetch("http://coffee-scale.local:1122/api/info");(i=>{let r=[];for(let e=0;e<i.history.length-1;e+=2)r.push([i.history[e],i.history[e+1]/100]);n.updateOptions({series:[{data:r}],annotations:{xaxis:[{id:"estimatedTime",x:i.mode.estimatedTime,label:{text:"ETA"}}],yaxis:[{id:"targetWeight",y:i.mode.targetWeight,label:{text:"Target"}}]}});const l=0!==i.mode.stopwatchStart?i.currentTime-i.mode.stopwatchStart:0;document.querySelector(o).innerHTML=i.currentMode.toUpperCase(),document.querySelector(e).innerHTML=`${i.currentWeight.toFixed(1)}g`,document.querySelector(a).innerHTML=s(i.mode.estimatedTime-i.mode.stopwatchStart),document.querySelector(t).innerHTML=s(l)})(await i.json())}catch(e){console.info(e)}l=!1}}),1e3);